<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>TanujaNikitha AI Chat Bot</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

<style>
:root {
    --bg-start:#ffd1dc;
    --bg-end:#d0f4de;
    --card:#ffffff;
    --border:linear-gradient(45deg,#ff6b6b,#ffb86c,#a0e7e5,#6bcf7f);
    --user-start:#ff9a9e;
    --user-end:#fad0c4;
    --bot-start:#a1c4fd;
    --bot-end:#c2e9fb;
    --accent:#ff6b6b;
    --text:#2d3436;
}

*{margin:0;padding:0;box-sizing:border-box}

body{
    font-family:'Poppins',sans-serif;
    background:linear-gradient(135deg,var(--bg-start),var(--bg-end));
    min-height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
}

#chat-container{
    width:100%;
    max-width:480px;
    background:var(--card);
    border-radius:1.8rem;
    padding:1.5rem;
    box-shadow:0 12px 40px rgba(0,0,0,.15);
    position:relative;
    border:4px solid transparent;
    background-clip:padding-box;
}
#chat-container::before{
    content:"";
    position:absolute;
    inset:-4px;
    background:var(--border);
    border-radius:1.8rem;
    z-index:-1;
}

h2{
    text-align:center;
    margin-bottom:1rem;
}

#chat-box{
    max-height:420px;
    overflow-y:auto;
    display:flex;
    flex-direction:column;
    gap:.6rem;
    padding:.5rem;
}

.message{
    max-width:78%;
    padding:.7rem 1.1rem;
    border-radius:1.4rem;
    font-size:.95rem;
    line-height:1.5;
    position:relative;
}
.user{
    align-self:flex-end;
    background:linear-gradient(135deg,var(--user-start),var(--user-end));
    color:#fff;
}
.bot{
    align-self:flex-start;
    background:linear-gradient(135deg,var(--bot-start),var(--bot-end));
}

.loading{
    align-self:center;
    font-style:italic;
    color:var(--accent);
}

.lang-label{
    font-size:.65rem;
    position:absolute;
    bottom:-16px;
    right:12px;
    opacity:.7;
}

.input-container{
    display:flex;
    background:#f4f4f4;
    border-radius:2rem;
    margin-top:.8rem;
    padding:.4rem;
}

#user-input{
    flex:1;
    border:none;
    outline:none;
    background:transparent;
    padding:.7rem 1rem;
    font-size:1rem;
}

button{
    border:none;
    cursor:pointer;
    border-radius:50%;
    width:42px;
    height:42px;
    background:linear-gradient(45deg,#ff6b6b,#ffb86c,#a0e7e5,#6bcf7f);
    color:#fff;
    font-size:1.1rem;
}
</style>
</head>

<body>

<div id="chat-container">
    <h2>TanujaNikitha AI Chat Bot</h2>

    <div id="chat-box"></div>

    <div class="input-container">
        <input id="user-input" placeholder="Ask me anythingâ€¦" 
               onkeydown="if(event.key==='Enter'){sendMessage()}">
        <button onclick="sendMessage()">âž¤</button>
        <button onclick="startVoiceInput()">ðŸŽ¤</button>
    </div>
</div>

<script>
const API_URL = "http://54.82.6.192:8080";

// SEND MESSAGE
async function sendMessage(msg=null){
    const input=document.getElementById("user-input");
    const text=msg||input.value.trim();
    if(!text) return;

    appendMessage(text,"user");
    appendMessage("Typingâ€¦","loading");
    input.value="";

    try{
        const res = await fetch(API_URL+"/chat",{
            method:"POST",
            headers:{"Content-Type":"application/json"},
            body:JSON.stringify({message:text})
        });

        document.querySelector(".loading")?.remove();
        const data = await res.json();

        appendMessage(data.response,"bot",data.language);
    }catch{
        appendMessage("Server error","bot");
    }
}

// APPEND MESSAGE
function appendMessage(text,type,lang=null){
    const box=document.getElementById("chat-box");
    const div=document.createElement("div");
    div.className="message "+type;
    div.textContent=text;

    if(lang){
        const l=document.createElement("div");
        l.className="lang-label";
        l.textContent=lang.toUpperCase();
        div.appendChild(l);
    }

    box.appendChild(div);
    box.scrollTop=box.scrollHeight;
}

// VOICE INPUT (AUTO LANGUAGE)
function startVoiceInput(){
    const R = window.SpeechRecognition || window.webkitSpeechRecognition;
    if(!R) return alert("Voice not supported");

    const rec = new R();
    rec.lang = navigator.language || "en-US";

    rec.onresult = e=>{
        sendMessage(e.results[0][0].transcript);
    };
    rec.start();
}
</script>

</body>
</html>
